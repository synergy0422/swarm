# Milestone v1.8: 诊断快照

**Status:** ✅ SHIPPED 2026-02-03
**Phases:** 23
**Total Plans:** 1

## Overview

一键采集 tmux swarm 运行状态，输出到时间戳目录用于诊断分析。实现 `scripts/swarm_snapshot.sh` 脚本，支持参数配置和只读操作。

## Phases

### Phase 23: 快照脚本实现

**Goal**: 实现 `scripts/swarm_snapshot.sh` 脚本

**Depends on**: Phase 22 (v1.7 5窗格布局)

**Plans**: 1 plan

Plans:

- [x] 23-PLAN.md — 快照脚本实现

**Details:**

**Requirements:**
- SNAP-01 ~ SNAP-09 (快照脚本功能)
- DOCS-01, DOCS-02 (文档更新)

**Success Criteria:**
1. 脚本支持 `--session` / `--lines` / `--out` 参数
2. 脚本输出 tmux 结构信息到快照目录
3. 脚本捕获每个 pane 的最近 N 行输出
4. 脚本记录状态文件和锁目录（如存在）
5. 脚本记录 git 版本信息
6. 脚本不创建/修改任何状态文件

---

## Milestone Summary

### Key Decisions

- D01: Use `[session:window.pane]` prefix for pane output — Clear source identification when viewing multiple panes
- D02: Default 50 lines per pane — Balance between context and information density
- D03: Auto-append timestamp for directory conflicts — Avoid manual cleanup, reduce risk of data loss
- D04: Mark missing files as "NOT FOUND" in summary — Visibility into what data was available
- D05: Exit code 1 if session not found — Strict session requirement for reliable diagnostics
- D06: Exit code 0 for partial failures — "部分失败继续执行" strategy, optional files don't cause errors

### Issues Resolved

- Fixed: Session not found continued execution (changed to exit 1)
- Fixed: Exit code logic inconsistent with partial failure strategy
- Enhanced: Summary shows "(missing)" for optional files not found

### Issues Deferred

- None

### Technical Debt

- None

---

_For current project status, see .planning/ROADMAP.md_
